export MUJOCO_GL=egl;
export CUDA_VISIBLE_DEVICES=0;
export MUJOCO_EGL_DEVICE_ID=0;

DATASET_ROOT=continuallearning;
CHECKPOINT_ROOT=./outputs;

STEPS=20000;
LOG_STEPS=100;
N_EVAL=100;
BS_EVAL=50;

python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_0_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_0_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_0 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_cfg_path=./peft_lsy/peft_config/clare_dit_flow_encoder_adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_1_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_1_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_1 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_0_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_2_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_2_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_2 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_1_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_3_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_3_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_3 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2,Libero_10_Task_3 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_2_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_4_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_4_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_4 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2,Libero_10_Task_3,Libero_10_Task_4 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_3_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_5_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_5_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_5 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2,Libero_10_Task_3,Libero_10_Task_4,Libero_10_Task_5 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_4_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_6_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_6_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_6 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2,Libero_10_Task_3,Libero_10_Task_4,Libero_10_Task_5,Libero_10_Task_6 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_5_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_7_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_7_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_7 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2,Libero_10_Task_3,Libero_10_Task_4,Libero_10_Task_5,Libero_10_Task_6,Libero_10_Task_7 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_6_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_8_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_8_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_8 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2,Libero_10_Task_3,Libero_10_Task_4,Libero_10_Task_5,Libero_10_Task_6,Libero_10_Task_7,Libero_10_Task_8 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_7_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY> \
&& \
python ./lerobot_lsy/src/lerobot/scripts/clare.py \
    --seed=42 \
    --job_name=dit_flow_mt_cl_seed_42_libero_10_task_9_encoder_mlp_adapter_threshold_1_0 \
    --output_dir=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_9_encoder_mlp_adapter_threshold_1_0 \
    --dataset.repo_id=continuallearning/libero_10_image_task_9 \
    --policy.path=./outputs/dit_flow_mt_libero_90_pretrain_new \
    --policy.push_to_hub=false \
    --batch_size=32 \
    --num_workers=16 \
    --steps=$STEPS \
    --env.type=libero \
    --env.task=Libero_10_Task_0,Libero_10_Task_1,Libero_10_Task_2,Libero_10_Task_3,Libero_10_Task_4,Libero_10_Task_5,Libero_10_Task_6,Libero_10_Task_7,Libero_10_Task_8,Libero_10_Task_9 \
    --eval.batch_size=$BS_EVAL \
    --eval.n_episodes=$N_EVAL \
    --eval.max_episodes_rendered=100 \
    --eval_freq=200000 \
    --save_freq=$STEPS \
    --log_freq=$LOG_STEPS \
    --peft_weight_path=./outputs/dit_flow_mt_cl_seed_42_libero_10_task_8_encoder_mlp_adapter_threshold_1_0/checkpoints/last/adapter \
    --expand_threshold=1.0 \
    --detect_distribution_shift_steps=200 \
    --detect_distribution_shift_batch_size=32 \
    --detect_distribution_shift_num_workers=16 \
    --detect_distribution_shift_log_freq=10 \
    --train_discriminators_steps=2000 \
    --train_discriminators_batch_size=32 \
    --train_discriminators_num_workers=16 \
    --train_discriminators_log_freq=50 \
    --train_discriminators_eval_freq=2000 \
    --train_discriminators_save_freq=2000 \
    --wandb.enable=true \
    --wandb.disable_artifact=true \
    --wandb.project=clare_experiments \
    --wandb.entity=<YOUR_WANDB_ENTITY>;